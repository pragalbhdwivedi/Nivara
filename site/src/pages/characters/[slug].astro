---
import MarkdownPage from "../../layouts/MarkdownPage.astro";
import { getCanonCharacters, renderCanonMarkdown } from "../../utils/canon.js";

export async function getStaticPaths() {
  const { characterEntries } = await getCanonCharacters();
  return characterEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { routeMap } = await getCanonCharacters();
const { html, toc } = await renderCanonMarkdown(entry.filePath, routeMap);
const title = `Nivara | ${entry.label}`;
---

<MarkdownPage title={title} heading={entry.label} sections={[{ html }]} toc={toc} />
